---
title: "Kasser_Ryan_1993"
author: "Leopold Roth"
date: "2023-11-24"
output: html_document
---

# Packages
```{r}
library(dplyr)
library(readr)
library(readxl)
library(haven)
library(misty)
```

# Load Data
```{r}
df <- read_sav("data/[PCIRR] Kasser and Ryan (1993) replication CR_1993 [Team Leo]_NOCHECKS_December 14, 2023_07.52.sav")
df <- as.data.frame(df)
#N initial:
```

# Check data
## exclude incomplete cases
```{r}
df<-subset(df, as.numeric(Progress) == 100)
#N complete:
```

## exclude by conduction time (3SD faster than average)
```{r}
df$Duration__in_seconds_<-as.numeric(df$Duration__in_seconds_)
sd_duration<-(sd(df$Duration__in_seconds_)*3) #compute 3 times SD of duration
mean_duration<-mean(df$Duration__in_seconds_) #compute mean duration
cut_duration<-mean_duration-sd_duration #minimum time cut-off = mean time - three SD
df<-subset(df,df$Duration__in_seconds_>=cut_duration) #filter out cases with shorter usage
#N after time exclusion:
```

## exclude by missed attention checks (3 attention checks)
```{r}
df<-subset(df, AT_1 == 5)
df<-subset(df, AT_2 == 1)
df<-subset(df, AT_3 == 3)

#N after attention exclusion (final N):
```

# Clean data
## exclude columns of attention checks
```{r}
df <- df %>% select(-c("AT_1", "AT_2", "AT_3"))

```

## TODOexclude non-needed columns
```{r}

```
## recode variables
```{r}
#self-actualization
df <- df %>%
  mutate(across(grep("^SA_.*_R$", names(df), value = TRUE), ~case_when(
    . == 1 ~ 4,
    . == 2 ~ 3,
    . == 3 ~ 2,
    . == 4 ~ 1,
    TRUE ~ . # keeps original value if none of the above conditions are met
  )))

#vitality
df <- df %>%
  mutate(across(grep("^VI_.*_R$", names(df), value = TRUE), ~case_when(
    . == 1 ~ 7,
    . == 2 ~ 6,
    . == 3 ~ 5,
    . == 4 ~ 4,
    . == 5 ~ 3,
    . == 6 ~ 2,
    . == 7 ~ 1,
    TRUE ~ . # keeps original value if none of the above conditions are met
  )))

#depressive symptoms
df <- df %>%
  mutate(across(grep("CES_.*_R$", names(df), value = TRUE), ~case_when(
    . == 0 ~ 3,
    . == 1 ~ 2,
    . == 2 ~ 1,
    . == 3 ~ 0,
    TRUE ~ . # keeps original value if none of the above conditions are met
  )))

#trait anxiety
df <- df %>%
  mutate(across(grep("AN_.*_R$", names(df), value = TRUE), ~case_when(
    . == 4 ~ 1,
    . == 3 ~ 2,
    . == 2 ~ 3,
    . == 1 ~ 4,
    TRUE ~ . # keeps original value if none of the above conditions are met
  )))
```


## rename variables (remove _R from recode variables)
```{r}
#self-actualization
names(df) <- ifelse(grepl("^SA_", names(df)), gsub("_R$", "", names(df)), names(df))
#vitality
names(df) <- ifelse(grepl("^VI_", names(df)), gsub("_R$", "", names(df)), names(df))
#depressive symptoms
names(df) <- ifelse(grepl("^CES_", names(df)), gsub("_R$", "", names(df)), names(df))
#trait anxiety
names(df) <- ifelse(grepl("^AN_", names(df)), gsub("_R$", "", names(df)), names(df))


```

#Descriptives
## compute reliabilities
```{r}
#Aspiration index: importance
psych::alpha(df%>% select(starts_with("ASP_SAI")))[[1]]
psych::alpha(df%>% select(starts_with("ASP_AFI")))[[1]]
psych::alpha(df%>% select(starts_with("ASP_CFI")))[[1]]
psych::alpha(df%>% select(starts_with("ASP_FSI")))[[1]]

#Aspiration index: chances
psych::alpha(df%>% select(starts_with("ASP_SAC")))[[1]]
psych::alpha(df%>% select(starts_with("ASP_AFC")))[[1]]
psych::alpha(df%>% select(starts_with("ASP_CFC")))[[1]]
psych::alpha(df%>% select(starts_with("ASP_FSC")))[[1]]

#Guiding principles:
## money
psych::alpha(df%>%select(grep("^GPR_.*_1$", names(df), value = TRUE)))[[1]]
##family security
psych::alpha(df%>%select(grep("^GPR_.*_2$", names(df), value = TRUE)))[[1]]
##global welfare
psych::alpha(df%>%select(grep("^GPR_.*_3$", names(df), value = TRUE)))[[1]]
##spirituality
psych::alpha(df%>%select(grep("^GPR_.*_4$", names(df), value = TRUE)))[[1]]
##hedonism
psych::alpha(df%>%select(grep("^GPR_.*_5$", names(df), value = TRUE)))[[1]]

#self-actualization
psych::alpha(df%>% select(starts_with("SA_")))[[1]]
#vitality
psych::alpha(df%>% select(starts_with("VI_")))[[1]]
#control orientation (only care about control-subscale)
psych::alpha(df%>%select(grep("^CO_.*_C$", names(df), value = TRUE)))[[1]]
#depressive symptoms
psych::alpha(df%>% select(starts_with("CES_")))[[1]]
#trait anxiety
psych::alpha(df%>% select(starts_with("AN_")))[[1]]
test




```

## demographics
```{r}
#describe age:
psych::describe(df$age)

#describe best identified gender:
table(df$gender)

```

## compute means
```{r}

```

## describe distribution of means
```{r}

```

## intercorrelations of means
```{r}

```

# Analysis Kasser & Ryan (1993)
## Preliminary analysis
```{r}
#MANOVA: all aspiration importances by sex (4)
#ChatGPT example:
#manova_result <- manova(cbind(var1, var2, var3, var4) ~ sex, data = data)
#summary(manova_result)
#MANOVA: all aspiration chances by sex (4)
#follow-up t-tests by gender
#exclude non-binary??

#interaction: DV (self-act. or vitality) ~ gender + overall_asp (importance or chances) + aspiration_domain*gender
#16 interactions:
#self_act_mean ~ overall_asp_importance + importance_acceptance*gender (example)

#intercorrelate all importance (put in one)
#intercorrelate all chances
```

## Primary analysis
### hierarchical regressions
```{r}
#m1<-vitality_mean ~ overall_asp_importance
#m2<-vitality_mean ~ overall_asp_importance + importance_acceptance + importance_affiliation + importance_community + #importance_finance (see betas Table 2)

#m1<-self_act_mean ~ overall_asp_importance
#m2<-self_act_mean ~ overall_asp_importance + importance_acceptance + importance_affiliation + importance_community + #importance_finance

#zero-order correlations importances with outcomes (vitality or self_actualization)
```

### group comparisons (assessment of relative centrality)
```{r}
#z-standardize raw scores of all eight means (importances and chances)
#form dichotomized variables: e.g. 1 if financial importance is higher than community, otherwise 0
## FSI vs SAI
## FSI vs AFI
## FSI vs CFI
## FSC vs SAC
## FSC vs AFC
## FSC vs CFC
```

### guiding principles
```{r}
#average position across three sets for each guiding principle
#assess five guiding principles but only consider three
#correlate with measures (e.g. self_actualization)

#centrality analysis (through z-standardization again)
#t-tests
```





